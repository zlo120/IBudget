<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        x:Class="IBudget.GUI.Views.InitialisationWindow"
		xmlns:vm="using:IBudget.GUI.ViewModels"
		xmlns:converters="using:IBudget.GUI.Converters"
		x:DataType="vm:InitialisationViewModel"
		x:CompileBindings="True"
        Title="Initialising"
        Icon="/Assets/stacks-logo.ico"
        Width="400" Height="300"
        WindowStartupLocation="CenterScreen"
        CanResize="False">
	<Window.Resources>
		<converters:DatabaseTypeConverter x:Key="DatabaseTypeConverter"/>
	</Window.Resources>
	
	<StackPanel Margin="20" Spacing="15">
		<TextBlock Text="Connecting to Database..."
                   FontSize="18"
                   FontWeight="Bold"
                   HorizontalAlignment="Center"/>

		<StackPanel Spacing="10">
			<TextBlock Text="Connection Type:"
                       FontWeight="SemiBold"
                       HorizontalAlignment="Left"/>
			
			<ComboBox ItemsSource="{Binding DatabaseTypes}"
                      SelectedItem="{Binding SelectedDatabaseType}"
                      HorizontalAlignment="Stretch">
				<ComboBox.ItemTemplate>
					<DataTemplate>
						<TextBlock Text="{Binding Converter={StaticResource DatabaseTypeConverter}}"/>
					</DataTemplate>
				</ComboBox.ItemTemplate>
			</ComboBox>

			<TextBlock Text="{Binding StatusMessage}"
                       TextWrapping="Wrap"
                       HorizontalAlignment="Center"/>

			<ProgressBar IsIndeterminate="{Binding IsConnecting}"
                         Height="10"
						 IsVisible="{Binding IsMongoTypeSelected}" />

			<StackPanel Orientation="Horizontal"
                        HorizontalAlignment="Center"
                        Spacing="10"
                        IsVisible="{Binding !IsConnecting}">
				<Button Content="Test Connection"
                        Command="{Binding TestConnectionCommand}"
                        IsVisible="{Binding IsMongoTypeSelected}"/>
				<Button Content="Configure Settings"
                        Command="{Binding ConfigureSettingsCommand}"
                        IsVisible="{Binding IsMongoTypeSelected}"/>
				<Button Content="Continue"
                        Command="{Binding OfflineContinueCommand}"
                        IsVisible="{Binding !IsMongoTypeSelected}"/>
			</StackPanel>
		</StackPanel>
	</StackPanel>
</Window>