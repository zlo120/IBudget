<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="IBudget.GUI.Views.DataView.MonthlyView"
             xmlns:vm="using:IBudget.GUI.ViewModels.DataView"
             x:DataType="vm:MonthlyViewModel"
             x:CompileBindings="True">

	<UserControl.Styles>
		<!-- Header Card Style -->
		<Style Selector="Border.header-card">
			<Setter Property="Background" Value="{DynamicResource CardBackgroundFillColorDefaultBrush}"/>
			<Setter Property="CornerRadius" Value="12"/>
			<Setter Property="Padding" Value="24,16"/>
			<Setter Property="BorderBrush" Value="{DynamicResource CardStrokeColorDefaultBrush}"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="BoxShadow" Value="0 2 8 0 #0D000000"/>
			<Setter Property="Margin" Value="0,0,0,16"/>
		</Style>

		<!-- Goal Card Style - Under Budget (White) -->
		<Style Selector="Border.goal-card-under">
			<Setter Property="Background" Value="White"/>
			<Setter Property="CornerRadius" Value="12"/>
			<Setter Property="Padding" Value="20"/>
			<Setter Property="BorderBrush" Value="{DynamicResource CardStrokeColorDefaultBrush}"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="BoxShadow" Value="0 2 8 0 #0D000000"/>
			<Setter Property="Margin" Value="8"/>
			<Setter Property="MinWidth" Value="280"/>
		</Style>

		<!-- Goal Card Style - Over Budget (Yellow) -->
		<Style Selector="Border.goal-card-over">
			<Setter Property="Background" Value="#FFC107"/>
			<Setter Property="CornerRadius" Value="12"/>
			<Setter Property="Padding" Value="20"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="BoxShadow" Value="0 2 8 0 #0D000000"/>
			<Setter Property="Margin" Value="8"/>
			<Setter Property="MinWidth" Value="280"/>
		</Style>

		<!-- Tracked Tag Card Style -->
		<Style Selector="Border.tracked-tag-card">
			<Setter Property="Background" Value="{DynamicResource CardBackgroundFillColorDefaultBrush}"/>
			<Setter Property="CornerRadius" Value="12"/>
			<Setter Property="Padding" Value="20"/>
			<Setter Property="BorderBrush" Value="{DynamicResource CardStrokeColorDefaultBrush}"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="BoxShadow" Value="0 2 8 0 #0D000000"/>
			<Setter Property="Margin" Value="8"/>
			<Setter Property="MinWidth" Value="200"/>
		</Style>

		<!-- Other Card Style -->
		<Style Selector="Border.other-card">
			<Setter Property="Background" Value="#E0E0E0"/>
			<Setter Property="CornerRadius" Value="12"/>
			<Setter Property="Padding" Value="20"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="BoxShadow" Value="0 2 8 0 #0D000000"/>
			<Setter Property="Margin" Value="8"/>
			<Setter Property="MinWidth" Value="200"/>
		</Style>

		<!-- Total Spending Card Style -->
		<Style Selector="Border.total-card">
			<Setter Property="Background" Value="#2196F3"/>
			<Setter Property="CornerRadius" Value="12"/>
			<Setter Property="Padding" Value="20"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="BoxShadow" Value="0 4 12 0 #1A000000"/>
			<Setter Property="MinWidth" Value="250"/>
		</Style>

		<!-- Total Income Card Style -->
		<Style Selector="Border.total-income-card">
			<Setter Property="Background" Value="#4CAF50"/>
			<Setter Property="CornerRadius" Value="12"/>
			<Setter Property="Padding" Value="20"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="BoxShadow" Value="0 4 12 0 #1A000000"/>
			<Setter Property="MinWidth" Value="250"/>
		</Style>

		<!-- Difference Card Style - Surplus (White) -->
		<Style Selector="Border.difference-card">
			<Setter Property="Background" Value="White"/>
			<Setter Property="CornerRadius" Value="12"/>
			<Setter Property="Padding" Value="20"/>
			<Setter Property="BorderBrush" Value="{DynamicResource CardStrokeColorDefaultBrush}"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="BoxShadow" Value="0 4 12 0 #1A000000"/>
			<Setter Property="MinWidth" Value="250"/>
		</Style>

		<!-- Difference Card Style - Deficit (Yellow) -->
		<Style Selector="Border.difference-card-deficit">
			<Setter Property="Background" Value="#FFC107"/>
			<Setter Property="CornerRadius" Value="12"/>
			<Setter Property="Padding" Value="20"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="BoxShadow" Value="0 4 12 0 #1A000000"/>
			<Setter Property="MinWidth" Value="250"/>
		</Style>

		<!-- Section Header Style -->
		<Style Selector="TextBlock.section-header">
			<Setter Property="FontSize" Value="20"/>
			<Setter Property="FontWeight" Value="SemiBold"/>
			<Setter Property="Foreground" Value="{DynamicResource TextFillColorPrimaryBrush}"/>
			<Setter Property="Margin" Value="0,0,0,16"/>
		</Style>

		<!-- Month Selector Style -->
		<Style Selector="ComboBox.month-selector">
			<Setter Property="FontSize" Value="18"/>
			<Setter Property="FontWeight" Value="Medium"/>
			<Setter Property="Padding" Value="16,8"/>
			<Setter Property="CornerRadius" Value="8"/>
			<Setter Property="MinWidth" Value="150"/>
		</Style>
	</UserControl.Styles>

	<ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
		<Grid RowDefinitions="Auto,*" Margin="24" MinWidth="600">

			<!-- Header Section -->
			<Border Classes="header-card" Grid.Row="0">
				<Grid ColumnDefinitions="Auto,*,Auto">
					<StackPanel Grid.Column="0" Spacing="4">
						<TextBlock Text="Monthly Spending Overview"
	                              Classes="section-header"/>
						<TextBlock Text="Track your spending by category and financial goals"
	                              FontSize="14"
	                              Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
					</StackPanel>

					<ComboBox Grid.Column="2"
	                         Classes="month-selector"
	                         SelectedIndex="{Binding SelectedIndex}"
	                         HorizontalAlignment="Right">
						<ComboBoxItem Content="January"/>
						<ComboBoxItem Content="February"/>
						<ComboBoxItem Content="March"/>
						<ComboBoxItem Content="April"/>
						<ComboBoxItem Content="May"/>
						<ComboBoxItem Content="June"/>
						<ComboBoxItem Content="July"/>
						<ComboBoxItem Content="August"/>
						<ComboBoxItem Content="September"/>
						<ComboBoxItem Content="October"/>
						<ComboBoxItem Content="November"/>
						<ComboBoxItem Content="December"/>
					</ComboBox>
				</Grid>
			</Border>

			<!-- Main Content -->
			<Grid Grid.Row="1" ColumnDefinitions="2*,1*" Margin="0,16,0,0">
				
				<!-- Left Side: Spending Breakdown -->
				<ScrollViewer Grid.Column="0" 
				             VerticalScrollBarVisibility="Auto"
				             HorizontalScrollBarVisibility="Disabled"
				             Padding="0,0,8,0">
					<StackPanel Spacing="24">

						<!-- Financial Goals Section -->
						<StackPanel Spacing="12" IsVisible="{Binding FinancialGoalSpending.Count}">
							<TextBlock Text="Financial Goals"
							          Classes="section-header"/>
							
							<ItemsControl ItemsSource="{Binding FinancialGoalSpending}">
								<ItemsControl.ItemsPanel>
									<ItemsPanelTemplate>
										<WrapPanel Orientation="Horizontal"/>
									</ItemsPanelTemplate>
								</ItemsControl.ItemsPanel>
								<ItemsControl.ItemTemplate>
									<DataTemplate>
										<Panel>
											<!-- Under Budget Card (White) -->
											<Border Classes="goal-card-under" IsVisible="{Binding !IsOverBudget}">
												<StackPanel Spacing="12">
													<TextBlock Text="{Binding TagName}"
													          FontSize="18"
													          FontWeight="SemiBold"
													          Foreground="#333333"/>
												
													<Grid RowDefinitions="Auto,Auto,Auto" ColumnDefinitions="Auto,*">
														<!-- Goal Amount -->
														<TextBlock Grid.Row="0" Grid.Column="0"
														          Text="Goal:"
														          FontSize="14"
														          Foreground="#666666"
														          Margin="0,0,8,4"/>
														<TextBlock Grid.Row="0" Grid.Column="1"
														          Text="{Binding FormattedGoalAmount}"
														          FontSize="14"
														          FontWeight="SemiBold"
														          Foreground="#333333"
														          HorizontalAlignment="Right"
														          Margin="0,0,0,4"/>
													
														<!-- Actual Spending -->
														<TextBlock Grid.Row="1" Grid.Column="0"
														          Text="Actual:"
														          FontSize="14"
														          Foreground="#666666"
														          Margin="0,0,8,4"/>
														<TextBlock Grid.Row="1" Grid.Column="1"
														          Text="{Binding FormattedActualSpending}"
														          FontSize="14"
														          FontWeight="SemiBold"
														          Foreground="#333333"
														          HorizontalAlignment="Right"
														          Margin="0,0,0,4"/>
													
														<!-- Difference -->
														<TextBlock Grid.Row="2" Grid.Column="0"
														          Text="{Binding DifferenceLabel}"
														          FontSize="14"
														          Foreground="#4CAF50"
														          FontWeight="Medium"
														          Margin="0,0,8,0"/>
														<TextBlock Grid.Row="2" Grid.Column="1"
														          Text="{Binding FormattedDifference}"
														          FontSize="16"
														          FontWeight="Bold"
														          Foreground="#4CAF50"
														          HorizontalAlignment="Right"/>
													</Grid>
												</StackPanel>
											</Border>

											<!-- Over Budget Card (Yellow) -->
											<Border Classes="goal-card-over" IsVisible="{Binding IsOverBudget}">
												<StackPanel Spacing="12">
													<TextBlock Text="{Binding TagName}"
													          FontSize="18"
													          FontWeight="SemiBold"
													          Foreground="#333333"/>
												
													<Grid RowDefinitions="Auto,Auto,Auto" ColumnDefinitions="Auto,*">
														<!-- Goal Amount -->
														<TextBlock Grid.Row="0" Grid.Column="0"
														          Text="Goal:"
														          FontSize="14"
														          Foreground="#666666"
														          Margin="0,0,8,4"/>
														<TextBlock Grid.Row="0" Grid.Column="1"
														          Text="{Binding FormattedGoalAmount}"
														          FontSize="14"
														          FontWeight="SemiBold"
														          Foreground="#333333"
														          HorizontalAlignment="Right"
														          Margin="0,0,0,4"/>
													
														<!-- Actual Spending -->
														<TextBlock Grid.Row="1" Grid.Column="0"
														          Text="Actual:"
														          FontSize="14"
														          Foreground="#666666"
														          Margin="0,0,8,4"/>
														<TextBlock Grid.Row="1" Grid.Column="1"
														          Text="{Binding FormattedActualSpending}"
														          FontSize="14"
														          FontWeight="SemiBold"
														          Foreground="#333333"
														          HorizontalAlignment="Right"
														          Margin="0,0,0,4"/>
													
														<!-- Difference -->
														<TextBlock Grid.Row="2" Grid.Column="0"
														          Text="{Binding DifferenceLabel}"
														          FontSize="14"
														          Foreground="#D32F2F"
														          FontWeight="Medium"
														          Margin="0,0,8,0"/>
														<TextBlock Grid.Row="2" Grid.Column="1"
														          Text="{Binding FormattedDifference}"
														          FontSize="16"
														          FontWeight="Bold"
														          Foreground="#D32F2F"
														          HorizontalAlignment="Right"/>
													</Grid>
												</StackPanel>
											</Border>
										</Panel>
									</DataTemplate>
								</ItemsControl.ItemTemplate>
							</ItemsControl>
						</StackPanel>

						<!-- Tracked Tags Section -->
						<StackPanel Spacing="12" IsVisible="{Binding TrackedTagSpending.Count}">
							<TextBlock Text="Other Tracked Tags"
							          Classes="section-header"/>
							
							<ItemsControl ItemsSource="{Binding TrackedTagSpending}">
								<ItemsControl.ItemsPanel>
									<ItemsPanelTemplate>
										<WrapPanel Orientation="Horizontal"/>
									</ItemsPanelTemplate>
								</ItemsControl.ItemsPanel>
								<ItemsControl.ItemTemplate>
									<DataTemplate>
										<Border Classes="tracked-tag-card">
											<StackPanel Spacing="8">
												<TextBlock Text="{Binding TagName}"
												          FontSize="16"
												          FontWeight="SemiBold"
												          Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
												<TextBlock Text="{Binding FormattedSpending}"
												          FontSize="20"
												          FontWeight="Bold"
												          Foreground="{DynamicResource AccentTextFillColorPrimaryBrush}"/>
											</StackPanel>
										</Border>
									</DataTemplate>
								</ItemsControl.ItemTemplate>
							</ItemsControl>
						</StackPanel>

						<!-- Other Spending Section -->
						<StackPanel Spacing="12">
							<TextBlock Text="Uncategorized Spending"
							          Classes="section-header"/>
							
							<Border Classes="other-card" HorizontalAlignment="Left">
								<StackPanel Spacing="8">
									<TextBlock Text="Other"
									          FontSize="16"
									          FontWeight="SemiBold"
									          Foreground="#333333"/>
									<TextBlock Text="{Binding OtherSpending, StringFormat='${0:F2}'}"
									          FontSize="20"
									          FontWeight="Bold"
									          Foreground="#333333"/>
								</StackPanel>
							</Border>
						</StackPanel>

					</StackPanel>
				</ScrollViewer>

				<!-- Right Side: Summary Cards -->
				<Grid Grid.Column="1" RowDefinitions="*,*,*" Margin="16,0,0,0">
					
					<!-- Total Spending Card -->
					<Border Classes="total-card" Grid.Row="0" Margin="0,0,0,8">
						<StackPanel VerticalAlignment="Center" Spacing="12">
							<!-- Total Icon -->
							<Border Background="White"
									CornerRadius="12"
									Width="60"
									Height="60"
									HorizontalAlignment="Center">
								<PathIcon Data="M12,1L21,5V11C21,16.55 17.16,21.74 12,23C6.84,21.74 3,16.55 3,11V5L12,1M12,7C10.34,7 9,8.34 9,10C9,11.66 10.34,13 12,13C13.66,13 15,11.66 15,10C15,8.34 13.66,7 12,7M6,17.25C6,15.18 8.41,13.53 12,13.53C15.59,13.53 18,15.18 18,17.25"
										 Width="28"
										 Height="28"
										 Foreground="#2196F3"
										 HorizontalAlignment="Center"
										 VerticalAlignment="Center"/>
							</Border>

							<!-- Total Content -->
							<StackPanel HorizontalAlignment="Center" Spacing="4">
								<TextBlock Text="Total Monthly Spending"
										  FontSize="15"
										  FontWeight="Medium"
										  Foreground="White"
										  Opacity="0.9"
										  HorizontalAlignment="Center"
										  TextWrapping="Wrap"
										  TextAlignment="Center"/>
								<TextBlock Text="{Binding TotalSpending, StringFormat='${0:F2}'}"
										  FontSize="28"
										  FontWeight="Bold"
										  Foreground="White"
										  HorizontalAlignment="Center"/>
							</StackPanel>
						</StackPanel>
					</Border>

					<!-- Total Income Card -->
					<Border Classes="total-income-card" Grid.Row="1" Margin="0,8,0,8">
						<StackPanel VerticalAlignment="Center" Spacing="12">
							<!-- Income Icon -->
							<Border Background="White"
									CornerRadius="12"
									Width="60"
									Height="60"
									HorizontalAlignment="Center">
								<PathIcon Data="M7,15H9C9,16.08 10.37,17 12,17C13.63,17 15,16.08 15,15C15,13.9 13.96,13.5 11.76,12.97C9.64,12.44 7,11.78 7,9C7,7.21 8.47,5.69 10.5,5.18V3H13.5V5.18C15.53,5.69 17,7.21 17,9H15C15,7.92 13.63,7 12,7C10.37,7 9,7.92 9,9C9,10.1 10.04,10.5 12.24,11.03C14.36,11.56 17,12.22 17,15C17,16.79 15.53,18.31 13.5,18.82V21H10.5V18.82C8.47,18.31 7,16.79 7,15Z"
										 Width="28"
										 Height="28"
										 Foreground="#4CAF50"
										 HorizontalAlignment="Center"
										 VerticalAlignment="Center"/>
							</Border>

							<!-- Income Content -->
							<StackPanel HorizontalAlignment="Center" Spacing="4">
								<TextBlock Text="Total Monthly Income"
										  FontSize="15"
										  FontWeight="Medium"
										  Foreground="White"
										  Opacity="0.9"
										  HorizontalAlignment="Center"
										  TextWrapping="Wrap"
										  TextAlignment="Center"/>
								<TextBlock Text="{Binding TotalIncome, StringFormat='${0:F2}'}"
										  FontSize="28"
										  FontWeight="Bold"
										  Foreground="White"
										  HorizontalAlignment="Center"/>
							</StackPanel>
						</StackPanel>
					</Border>

					<!-- Difference Card - Surplus (White Background) -->
					<Border Classes="difference-card" Grid.Row="2" Margin="0,8,0,0" IsVisible="{Binding !IsDeficit}">
						<StackPanel VerticalAlignment="Center" Spacing="12">
							<!-- Difference Icon -->
							<Border Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
									BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
									BorderThickness="1"
									CornerRadius="12"
									Width="60"
									Height="60"
									HorizontalAlignment="Center">
								<PathIcon Data="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"
										 Width="28"
										 Height="28"
										 Foreground="#4CAF50"
										 HorizontalAlignment="Center"
										 VerticalAlignment="Center"/>
							</Border>

							<!-- Difference Content -->
							<StackPanel HorizontalAlignment="Center" Spacing="4">
								<TextBlock Text="Net Monthly Difference"
										  FontSize="15"
										  FontWeight="Medium"
										  Foreground="#333333"
										  HorizontalAlignment="Center"
										  TextWrapping="Wrap"
										  TextAlignment="Center"/>
								<TextBlock Text="{Binding Difference, StringFormat='${0:F2}'}"
										  FontSize="28"
										  FontWeight="Bold"
										  Foreground="#333333"
										  HorizontalAlignment="Center"/>
							</StackPanel>
						</StackPanel>
					</Border>

					<!-- Difference Card - Deficit (Yellow Background) -->
					<Border Classes="difference-card-deficit" Grid.Row="2" Margin="0,8,0,0" IsVisible="{Binding IsDeficit}">
						<StackPanel VerticalAlignment="Center" Spacing="12">
							<!-- Difference Icon -->
							<Border Background="White"
									CornerRadius="12"
									Width="60"
									Height="60"
									HorizontalAlignment="Center">
								<PathIcon Data="M19,13H5V11H19V13Z"
										 Width="28"
										 Height="28"
										 Foreground="#FFC107"
										 HorizontalAlignment="Center"
										 VerticalAlignment="Center"/>
							</Border>

							<!-- Difference Content -->
							<StackPanel HorizontalAlignment="Center" Spacing="4">
								<TextBlock Text="Net Monthly Difference"
										  FontSize="15"
										  FontWeight="Medium"
										  Foreground="#333333"
										  HorizontalAlignment="Center"
										  TextWrapping="Wrap"
										  TextAlignment="Center"/>
								<TextBlock Text="{Binding Difference, StringFormat='${0:F2}'}"
										  FontSize="28"
										  FontWeight="Bold"
										  Foreground="#333333"
										  HorizontalAlignment="Center"/>
							</StackPanel>
						</StackPanel>
					</Border>

				</Grid>

			</Grid>

		</Grid>
	</ScrollViewer>
</UserControl>