<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="IBudget.GUI.Views.FinancialGoalsPageView"
			 xmlns:vm="using:IBudget.GUI.ViewModels"
			 x:DataType="vm:FinancialGoalsPageViewModel"
			 x:CompileBindings="True">

	<ScrollViewer VerticalScrollBarVisibility="Auto">
		<StackPanel Margin="30">
			<!-- Header Section -->
			<StackPanel Spacing="10" Margin="0,0,0,30">
				<TextBlock Text="Financial Goals Management"
                          FontSize="24"
                          FontWeight="Bold"
                          HorizontalAlignment="Center"
                          Foreground="{DynamicResource TextControlForeground}" />
				<TextBlock Text="Set and track your monthly spending targets and savings goals"
                          FontSize="14"
                          HorizontalAlignment="Center"
                          Opacity="0.7"
                          Foreground="{DynamicResource TextControlForeground}" />
			</StackPanel>

			<!-- Create Financial Goal Section -->
			<Border Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="25"
                    Margin="0,0,0,25">
				<StackPanel Spacing="20">
					<StackPanel Spacing="5">
						<TextBlock Text="🎯 Create New Financial Goal"
                                  FontSize="18"
                                  FontWeight="SemiBold"
                                  HorizontalAlignment="Center" />
						<TextBlock Text="Set spending limits and savings targets for better budget control"
                                  FontSize="12"
                                  HorizontalAlignment="Center"
                                  Opacity="0.7" />
					</StackPanel>

					<Grid RowDefinitions="Auto, Auto, Auto, Auto">
						<!-- Goal Name Input -->
						<StackPanel Grid.Row="0" Spacing="5" Margin="0,0,0,15">
							<TextBlock Text="Goal Name"
                                      FontSize="12"
                                      FontWeight="Medium"
                                      Opacity="0.8" />
							<AutoCompleteBox ItemsSource="{Binding Tags}"
                                            Text="{Binding GoalName}"
                                            Watermark="Enter or select goal name (e.g., groceries, entertainment)"
                                            Padding="12,8"
                                            CornerRadius="6" />
						</StackPanel>

						<!-- Amount Input -->
						<StackPanel Grid.Row="1" Spacing="5" Margin="0,0,0,15">
							<TextBlock Text="Target Amount"
                                      FontSize="12"
                                      FontWeight="Medium"
                                      Opacity="0.8" />
							<TextBox Text="{Binding Amount}"
                                    Watermark="Enter maximum spending amount (e.g., 500.00)"
                                    Padding="12,8"
                                    CornerRadius="6"
                                    TextInput="OnAmountTextInput"
                                    KeyDown="OnAmountKeyDown" />
						</StackPanel>

						<!-- Create Button and Message -->
						<Grid Grid.Row="2" ColumnDefinitions="*, Auto" Margin="0,0,0,15">
							<TextBlock Grid.Column="0"
                                      Text="{Binding Message}"
                                      FontSize="12"
                                      VerticalAlignment="Center"
                                      TextWrapping="Wrap"
                                      Foreground="{DynamicResource AccentTextFillColorPrimaryBrush}" />
							<Button Grid.Column="1"
                                   Content="Create Goal"
                                   Command="{Binding CreateGoalCommand}"
                                   Classes="accent"
                                   Padding="16,8"
                                   FontWeight="SemiBold"
                                   CornerRadius="6"
                                   IsDefault="True" />
						</Grid>

						<!-- Information Card -->
						<Border Grid.Row="3"
                               Background="{DynamicResource ControlFillColorInputActiveBrush}"
                               BorderBrush="{DynamicResource ControlStrokeColorDefaultBrush}"
                               BorderThickness="1"
                               CornerRadius="6"
                               Padding="15">
							<Grid ColumnDefinitions="Auto, *">
								<Border Grid.Column="0"
                                       Background="{DynamicResource AccentTextFillColorPrimaryBrush}"
                                       CornerRadius="20"
                                       Width="40"
                                       Height="40"
                                       Margin="0,0,15,0">
									<PathIcon Data="{StaticResource QuestionRegular}"
                                             Width="20"
                                             Height="20"
                                             Foreground="White"
                                             HorizontalAlignment="Center"
                                             VerticalAlignment="Center" />
								</Border>
								<StackPanel Grid.Column="1" Spacing="5">
									<TextBlock Text="💡 How Financial Goals Work"
                                              FontWeight="SemiBold"
                                              FontSize="14" />
									<TextBlock TextWrapping="Wrap"
                                              FontSize="12"
                                              Opacity="0.8"
                                              LineHeight="16">
										Financial goals are directly linked to your tags. When you create a goal, it automatically creates or links to a corresponding tag for expense tracking. This helps you monitor your spending against your set targets in budget reports.
									</TextBlock>
								</StackPanel>
							</Grid>
						</Border>
					</Grid>
				</StackPanel>
			</Border>

			<!-- Financial Goals List Section -->
			<Border Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
					BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
					BorderThickness="1"
					CornerRadius="8"
					Padding="25">
				<StackPanel Spacing="20">
					<!-- Section Header -->
					<StackPanel Spacing="5">
						<TextBlock Text="💰 Your Financial Goals"
								  FontSize="18"
								  FontWeight="SemiBold"
								  HorizontalAlignment="Center" />
						<TextBlock Text="{Binding FinancialGoals.Count, StringFormat='Managing {0} financial goals'}"
								  FontSize="12"
								  HorizontalAlignment="Center"
								  Opacity="0.7" />
					</StackPanel>

					<!-- Loading State -->
					<StackPanel IsVisible="{Binding IsLoading}"
							   Spacing="15"
							   HorizontalAlignment="Center">
						<TextBlock Text="🔄 Loading financial goals..."
								  FontSize="14"
								  HorizontalAlignment="Center"
								  Opacity="0.7" />
					</StackPanel>

					<!-- Goals Grid -->
					<ScrollViewer IsVisible="{Binding !IsLoading}"
								 VerticalScrollBarVisibility="Auto"
								 MaxHeight="500">
						<ItemsControl ItemsSource="{Binding FinancialGoals}">
							<ItemsControl.ItemsPanel>
								<ItemsPanelTemplate>
									<WrapPanel Orientation="Horizontal" />
								</ItemsPanelTemplate>
							</ItemsControl.ItemsPanel>
							<ItemsControl.ItemTemplate>
								<DataTemplate DataType="{x:Type vm:FinancialGoalListItem}">
									<Border Background="{DynamicResource ControlFillColorDefaultBrush}"
										   BorderBrush="{DynamicResource ControlStrokeColorDefaultBrush}"
										   BorderThickness="1"
										   CornerRadius="8"
										   Padding="20"
										   Margin="5"
										   MinWidth="250"
										   MaxWidth="300">
										<Grid RowDefinitions="Auto, Auto, Auto, Auto">
											<!-- Goal Name -->
											<StackPanel Grid.Row="0" Spacing="5" Margin="0,0,0,15">
												<TextBlock Text="Goal Name"
														  FontSize="11"
														  FontWeight="Medium"
														  Opacity="0.7" />
												<TextBlock Text="{Binding Key}"
														  FontSize="16"
														  FontWeight="SemiBold"
														  TextWrapping="Wrap"
														  Foreground="{DynamicResource TextControlForeground}" />
											</StackPanel>

											<!-- Target Amount -->
											<StackPanel Grid.Row="1" Spacing="5" Margin="0,0,0,15">
												<TextBlock Text="Monthly Target"
														  FontSize="11"
														  FontWeight="Medium"
														  Opacity="0.7" />
												<Border Background="{DynamicResource AccentTextFillColorPrimaryBrush}"
													   CornerRadius="6"
													   Padding="10,6"
													   HorizontalAlignment="Left">
													<TextBlock Text="{Binding Value}"
															  FontSize="18"
															  FontWeight="Bold"
															  Foreground="White" />
												</Border>
											</StackPanel>

											<!-- Status Badge -->
											<StackPanel Grid.Row="2" Spacing="5" Margin="0,0,0,15">
												<Border Background="{DynamicResource AccentTextFillColorSecondaryBrush}"
													   CornerRadius="12"
													   Padding="8,4"
													   HorizontalAlignment="Left">
													<StackPanel Orientation="Horizontal" Spacing="5">
														<TextBlock Text="📊"
																  FontSize="10"
																  VerticalAlignment="Center" />
														<TextBlock Text="Active Goal"
																  FontSize="10"
																  FontWeight="SemiBold"
																  VerticalAlignment="Center"
																  Foreground="White" />
													</StackPanel>
												</Border>
											</StackPanel>

											<!-- Actions -->
											<StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right">
												<Button Content="🗑️"
													   Width="36"
													   Height="36"
													   Padding="0"
													   Background="{DynamicResource SystemControlErrorTextForegroundBrush}"
													   Foreground="White"
													   CornerRadius="18"
													   CommandParameter="{Binding Key}"
													   Command="{Binding DeleteGoalCommand}"
													   ToolTip.Tip="Delete this financial goal"
													   FontSize="14" />
											</StackPanel>
										</Grid>
									</Border>
								</DataTemplate>
							</ItemsControl.ItemTemplate>
						</ItemsControl>
					</ScrollViewer>
				</StackPanel>
			</Border>

			<!-- Quick Stats Section -->
			<Border Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
					BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
					BorderThickness="1"
					CornerRadius="8"
					Padding="20"
					Margin="0,25,0,0">
				<Grid ColumnDefinitions="1*, 1*">
					<StackPanel Grid.Column="0" Spacing="5" HorizontalAlignment="Center">
						<TextBlock Text="{Binding FinancialGoals.Count, StringFormat='{}{0}'}"
								  FontSize="24"
								  FontWeight="Bold"
								  HorizontalAlignment="Center"
								  Foreground="{DynamicResource AccentTextFillColorPrimaryBrush}" />
						<TextBlock Text="Active Goals"
								  FontSize="12"
								  HorizontalAlignment="Center"
								  Opacity="0.7" />
					</StackPanel>

					<StackPanel Grid.Column="1" Spacing="5" HorizontalAlignment="Center">
						<TextBlock Text="{Binding Tags.Count, StringFormat='{}{0}'}"
								  FontSize="24"
								  FontWeight="Bold"
								  HorizontalAlignment="Center"
								  Foreground="{DynamicResource AccentTextFillColorSecondaryBrush}" />
						<TextBlock Text="Available Tags"
								  FontSize="12"
								  HorizontalAlignment="Center"
								  Opacity="0.7" />
					</StackPanel>
				</Grid>
			</Border>
		</StackPanel>
	</ScrollViewer>
</UserControl>