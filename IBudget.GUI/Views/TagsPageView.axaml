<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="IBudget.GUI.Views.TagsPageView"
			 xmlns:vm="using:IBudget.GUI.ViewModels"
			 xmlns:converters="using:IBudget.GUI.Converters"
			 x:DataType="vm:TagsPageViewModel"
			 x:CompileBindings="True">

	<ScrollViewer VerticalScrollBarVisibility="Auto">
		<StackPanel Margin="30">
			<!-- Header Section -->
			<StackPanel Spacing="10" Margin="0,0,0,30">
				<TextBlock Text="Tag Management"
                          FontSize="24"
                          FontWeight="Bold"
                          HorizontalAlignment="Center"
                          Foreground="{DynamicResource TextControlForeground}" />
				<TextBlock Text="Create, organize, and track your spending categories"
                          FontSize="14"
                          HorizontalAlignment="Center"
                          Opacity="0.7"
                          Foreground="{DynamicResource TextControlForeground}" />
			</StackPanel>

			<!-- Create Tag Section -->
			<Border Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="25"
                    Margin="0,0,0,25">
				<StackPanel Spacing="15">
					<StackPanel Spacing="5">
						<TextBlock Text="➕ Create New Tag"
                                  FontSize="18"
                                  FontWeight="SemiBold"
                                  HorizontalAlignment="Center" />
						<TextBlock Text="Add a new spending category to organize your expenses"
                                  FontSize="12"
                                  HorizontalAlignment="Center"
                                  Opacity="0.7" />
					</StackPanel>

					<Grid ColumnDefinitions="2*, 1*, Auto">
						<!-- Tag Name Input -->
						<StackPanel Grid.Column="0" Spacing="5" Margin="0,0,10,0">
							<TextBlock Text="Tag Name"
                                      FontSize="12"
                                      FontWeight="Medium"
                                      Opacity="0.8" />
							<TextBox Text="{Binding TagName}"
                                    Watermark="Enter tag name (e.g., groceries, entertainment)"
                                    Padding="12,8"
                                    CornerRadius="6" />
						</StackPanel>

						<!-- Is Tracked Toggle -->
						<StackPanel Grid.Column="1" Spacing="5" Margin="10,0">
							<TextBlock Text="Track in Reports"
                                      FontSize="12"
                                      FontWeight="Medium"
                                      Opacity="0.8" />
							<Border Background="{DynamicResource ControlFillColorDefaultBrush}"
                                   BorderBrush="{DynamicResource ControlStrokeColorDefaultBrush}"
                                   BorderThickness="1"
                                   CornerRadius="6"
                                   Padding="12,8">
								<StackPanel Orientation="Horizontal" Spacing="8">
									<CheckBox IsChecked="{Binding IsTracked}"
                                             VerticalAlignment="Center" />
									<TextBlock Text="Include in budget tracking"
                                              FontSize="12"
                                              VerticalAlignment="Center"
                                              Opacity="0.8" />
								</StackPanel>
							</Border>
						</StackPanel>

						<!-- Create Button -->
						<StackPanel Grid.Column="2" Spacing="5" VerticalAlignment="Bottom" Margin="10,0,0,0">
							<Button Content="Create Tag"
                                   Command="{Binding CreateTagCommand}"
                                   Classes="accent"
                                   Padding="16,8"
                                   FontWeight="SemiBold"
                                   CornerRadius="6"
                                   IsDefault="True" />
						</StackPanel>
					</Grid>

					<!-- Message Display -->
					<Border IsVisible="{Binding Message, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
                           Background="{DynamicResource ControlFillColorInputActiveBrush}"
                           BorderBrush="{DynamicResource AccentTextFillColorPrimaryBrush}"
                           BorderThickness="1"
                           CornerRadius="6"
                           Padding="12,8">
						<TextBlock Text="{Binding Message}"
                                  FontSize="12"
                                  FontWeight="Medium"
                                  TextWrapping="Wrap"
                                  Foreground="{DynamicResource AccentTextFillColorPrimaryBrush}" />
					</Border>
				</StackPanel>
			</Border>

			<!-- Tags List Section -->
			<Border Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="25">
				<StackPanel Spacing="20">
					<!-- Section Header -->
					<StackPanel Spacing="5">
						<TextBlock Text="🏷️ Your Tags"
                                  FontSize="18"
                                  FontWeight="SemiBold"
                                  HorizontalAlignment="Center" />
						<TextBlock Text="{Binding Tags.Count, StringFormat='Managing {0} tags'}"
                                  FontSize="12"
                                  HorizontalAlignment="Center"
                                  Opacity="0.7" />
					</StackPanel>

					<!-- Tags Grid -->
					<ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="500">
						<ItemsControl ItemsSource="{Binding Tags}">
							<ItemsControl.ItemsPanel>
								<ItemsPanelTemplate>
									<WrapPanel Orientation="Horizontal" />
								</ItemsPanelTemplate>
							</ItemsControl.ItemsPanel>
							<ItemsControl.ItemTemplate>
								<DataTemplate DataType="{x:Type vm:AllTagsListItemTemplate}">
									<Border Background="{DynamicResource ControlFillColorDefaultBrush}"
                                           BorderBrush="{DynamicResource ControlStrokeColorDefaultBrush}"
                                           BorderThickness="1"
                                           CornerRadius="8"
                                           Padding="15"
                                           Margin="5"
                                           MinWidth="200"
                                           MaxWidth="250">
										<Grid RowDefinitions="Auto, Auto, Auto">
											<!-- Tag Name and Status -->
											<StackPanel Grid.Row="0" Spacing="8" Margin="0,0,0,10">
												<TextBlock Text="{Binding TagName}"
                                                          FontSize="14"
                                                          FontWeight="SemiBold"
                                                          TextWrapping="Wrap"
                                                          Foreground="{DynamicResource TextControlForeground}" />
											</StackPanel>

											<!-- Tracking Toggle -->
											<StackPanel Grid.Row="1" Spacing="5" Margin="0,0,0,10">
												<StackPanel Orientation="Horizontal" Spacing="8">
													<CheckBox IsChecked="{Binding IsTracked}"
                                                             Command="{Binding UpdateIsTrackedCommand}"
                                                             VerticalAlignment="Center" />
													<TextBlock Text="Track this tag"
                                                              FontSize="11"
                                                              VerticalAlignment="Center"
                                                              Opacity="0.8" />
												</StackPanel>
											</StackPanel>

											<!-- Actions -->
											<StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right">
												<Button Content="🗑️"
                                                       Width="32"
                                                       Height="32"
                                                       Padding="0"
                                                       Background="{DynamicResource SystemControlErrorTextForegroundBrush}"
                                                       Foreground="White"
                                                       CornerRadius="16"
                                                       ToolTip.Tip="Delete this tag"
                                                       FontSize="12"
                                                       Click="OnIconButtonClick"
                                                       IsVisible="{Binding TagName, Converter={x:Static converters:StringNotEqualConverter.Instance}, ConverterParameter=ignored}" />
											</StackPanel>
										</Grid>
									</Border>
								</DataTemplate>
							</ItemsControl.ItemTemplate>
						</ItemsControl>
					</ScrollViewer>
				</StackPanel>
			</Border>

			<!-- Quick Stats Section -->
			<Border Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="20"
                    Margin="0,25,0,0">
				<Grid ColumnDefinitions="1*, 1*">
					<StackPanel Grid.Column="0" Spacing="5" HorizontalAlignment="Center">
						<TextBlock Text="{Binding Tags.Count, StringFormat='{}{0}'}"
                                  FontSize="24"
                                  FontWeight="Bold"
                                  HorizontalAlignment="Center"
                                  Foreground="{DynamicResource AccentTextFillColorPrimaryBrush}" />
						<TextBlock Text="Total Tags"
                                  FontSize="12"
                                  HorizontalAlignment="Center"
                                  Opacity="0.7" />
					</StackPanel>

					<StackPanel Grid.Column="1" Spacing="5" HorizontalAlignment="Center">
						<TextBlock Text="--"
                                  FontSize="24"
                                  FontWeight="Bold"
                                  HorizontalAlignment="Center"
                                  Foreground="{DynamicResource AccentTextFillColorSecondaryBrush}" />
						<TextBlock Text="Tracked Tags"
                                  FontSize="12"
                                  HorizontalAlignment="Center"
                                  Opacity="0.7" />
					</StackPanel>
				</Grid>
			</Border>
		</StackPanel>
	</ScrollViewer>
</UserControl>